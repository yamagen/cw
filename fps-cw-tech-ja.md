# FastText PCA-based Semantic ID (FPS-ID) による語識別と共起重み付き可視化の設計提案

## ✅ 目的

従来の `wlsp` (語識別と意味記述を目的とした表記体系) は、人手による語義分類やラベル付与に依存しており、スケーラビリティと客観性に限界があった。
本提案では、fastText によって得られる語の意味ベクトルを PCA で圧縮し、人間にも可読な数値IDとする **FPS-ID (FastText PCA-based Semantic ID)** を導入する。これにより、**語の意味を桟数で階層的に表現** しつつ、**意味的に類似する語を同一グループとみなす共起処理**を可能にする。

---

## ✅ 構想全体の流れ

```sh
% fsp input.txt | cw -k "fps-id" -digit 6 | graphviz -Tsvg -o output.svg
```

| 工程       | 内容                                                                                                    |
| ---------- | ------------------------------------------------------------------------------------------------------- |
| `fsp`      | 入力テキストから各語を抽出し、FastText → PCA によって FPS-ID を算出。1語1行の `streamtext.jsonl` を出力 |
| `cw`       | 与えられた `fps-id` の上位桟で語を同一グループとみなし、共起パターンを計算 (tf × √(idf₁×idf₂))          |
| `graphviz` | 共起関係をグラフ構造で可視化。意味的な塊が明示される                                                    |

---

## ✅ FPS-ID (FastText PCA-based Semantic ID) の仕様

### 基本構造:

- 入力: FastText (語べクトル)
- 圧縮: PCA (通常は2次元)
- 出力形式: `"fps-id": "23.61472983"`

### 桟数と意味の解像度:

| 桟数         | 解釈                          | 用途                   |
| ------------ | ----------------------------- | ---------------------- |
| `23`         | 意味クラスタ (例: 季節)       | 大分類の検索 / 分類    |
| `23.61`      | 類義語グループ (例: 春 vs 秋) | 意味的な整理           |
| `23.6147...` | 出現文脈ごとの意味差異        | 多義性の変動を複製対応 |

---

## ✅ streamtext.jsonl の例 (ᵀ語1行)

```json
{
  "form": "春",
  "lemma": "春",
  "pos": "NOUN",
  "fps-id": "23.48",
  "line": 12,
  "token_index": 3
}
```

---

## ✅ cw (cooccurrence pattern weighting program) の拡張仕様

### 機能概要

- 入力: `streamtext.jsonl`
- オプション:

  - `-k fps-id` : 使用するキー
  - `-digit 6` : 先頭6桟が一致する語を同一とみなす

- 出力: `fps-id1 fps-id2 weight`

### 重み計算:

```math
cw(t1, t2) = ctf × √(idf_1 × idf_2)
```

---

## ✅ 本方式の利点

### 構造面

- ✅ 意味ベースでの語識別が可能
- ✅ 桟数を変えるだけで抽象度を切り替え可
- ✅ 可読性が高く、視覚的意味が捜しやすい

### 計算面

- ✅ `cw` により重要な共起のみを自動選出
- ✅ 統計計量と意味の可視化が一体化

### 後出形式

- ✅ `graphviz` による意味分布のビジュアライゼーション
- ✅ 意味分類、類義語抽出、多義性処理に应用可

---

## ✅ 将来的希望

- `fpsid2text.tsv` の整備 (反読用 FPS-ID 語表)
- `fpsid-cluster-browser` の構築 (意味空間上の可視的ブラウズ)
- 他の語彙モデル (BERT 基盤) との組合せ検討

---

> **FPS-ID = FastText PCA-based Semantic ID**
> 意味の分布を数値化し、桟数で意味の抽象度を操作可能にした新型の語ID体系。

---
